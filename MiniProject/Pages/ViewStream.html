{% extends "/Pages/base.html" %}
{% block title %}Connex.us - View Stream {% endblock title %}
{% block styles %}
	body {
	  font-family: Verdana, sans-serif;
	  margin: 0;
	}

	* {
	  box-sizing: border-box;
	}
	
	.row{
	position: relative;

	}

	.row > .column {
	  padding: 0 8px;

	}

	.row:after {
	  content: "";
	  display: table;
	  clear: both;
	}

	.column {
	  float: left;
	  width: 25%;
	}

	.header {
		text-align: center;
		padding: 22px;
	}
	
	.row > #lastColumn {
	position: absolute;
    bottom: 5px;
	left: 90%;
    margin-left: -25px;
	}
	.addImage {
    border: 3px solid black;
	width:450px;
	height:150px;
	margin-left:5px;
	}
	.fileupload{
	margin-left: 16px;
	margin-right:16px;
	margin-top:16px;
	}
	#upload{
	margin-left: 16px;
	margin-bottom:16px;
	}
	#subscribe{
	margin-left: 16px;
	margin-bottom:16px;
	}


  #map {
	  height: 100%;
	  width: 100%;
  }

	#mapContainer {
		height: 640px;
		width: 960px;

		top:0;
		bottom: 0;
		left: 0;
		right: 0;

		margin: auto;
		margin-bottom: 50px;
	}


{% endblock styles %}

{% block content %}
	<div class="header">
	  <h1>{{ stream_name }}</h1>
	</div>
		<div class="row">
			{% for picture in pics %}
			  <div class="column">
				<img src="{{ picture[1] }}" height="256" width="256" onclick="openModal();currentSlide(1)" class="hover-shadow cursor">
			  </div>
			{% endfor %}
		  <div class="column" id="lastColumn">
			  <form action="ViewSingleStream" method="post">
				  <input type="text" name="stream_name" value="{{ stream.name }}" hidden="True">
				  <input type="text" name="decrementPage" value="{{ page }}" hidden="True">
				  <button type="submit" name="moreImages" id="moreImages">More Images</button>
			  </form>
		  </div>
		</div>
		</br>


		<script type="text/javascript" src="/dropzone/dropzone.js"></script>
		<link rel="stylesheet" href="/dropzone/dropzone.css">
			<!--<form action="ViewSingleStream" method="post" class="dropzone" id="my-dropzone">
				<input type="text" name="stream_name" value="{{ stream.name }}" hidden="True">
				<input type="text" name="page" value="{{ page }}" hidden="True">

			</form> -->

<div> <form action="ViewSingleStream" method="post" id="my-awesome-dropzone" class="dropzone">
  <div class="dropzone-previews"></div> <!-- this is were the previews should be shown. -->

  <!-- Now setup your input fields -->
  <input type="test" name="stream_name" value="{{ stream.name }}"  hidden="True"/>
	<input type="text" name="page" value="{{ page }}" hidden="True">

  <!--<button id="upload" type="submit">Submit data and files!</button> -->
</form> </div>

<script>
	Dropzone.options.myAwesomeDropzone = { // The camelized version of the ID of the form element

  // The configuration we've talked about above
  autoProcessQueue: true,
  uploadMultiple: false,
  parallelUploads: 1,
  maxFiles: 100,

  // The setting up of the dropzone
  init: function() {
    var myDropzone = this;

    // First change the button to actually tell Dropzone to process the queue.
    //this.element.querySelector("button[type=submit]").addEventListener("click", function(e) {
      // Make sure that the form isn't actually being sent.
      //e.preventDefault();
      //e.stopPropagation();
      //myDropzone.processQueue();
    //});
    this.on("sending", function(file, xhr, formData) {
      						var name = "name";
      						formData.append(name, file.name);
	  					});

    this.handleFiles = function(files) {
            var file, _i, _len, _results;
            _results = [];
            for (_i = 0, _len = files.length; _i < _len; _i++) {
                file = files[_i];
                _results.push(this.addFile(file));
                // Make sure we don't handle more files than requested
                if (this.options.maxFiles != null && this.options.maxFiles > 0 && _i >= (this.options.maxFiles - 1)) {
                    break;
                }
            }
            return _results;
        };
        this._addFilesFromItems = function(items) {
            var entry, item, _i, _len, _results;
            _results = [];
            for (_i = 0, _len = items.length; _i < _len; _i++) {
                item = items[_i];
                if ((item.webkitGetAsEntry != null) && (entry = item.webkitGetAsEntry())) {
                    if (entry.isFile) {
                        _results.push(this.addFile(item.getAsFile()));
                    } else if (entry.isDirectory) {
                        _results.push(this._addFilesFromDirectory(entry, entry.name));
                    } else {
                        _results.push(void 0);
                    }
                } else if (item.getAsFile != null) {
                    if ((item.kind == null) || item.kind === "file") {
                        _results.push(this.addFile(item.getAsFile()));
                    } else {
                        _results.push(void 0);
                    }
                } else {
                    _results.push(void 0);
                }
                // Make sure we don't handle more files than requested
                if (this.options.maxFiles != null && this.options.maxFiles > 0 && _i >= (this.options.maxFiles - 1)) {
                    break;
                }
            }
            return _results;
        };
  	}

}


</script>



		</br>
		<form action="Subscribe" method="get">
			<div class="subscribe">
				<button type="submit" name="subscribe" value="{{ stream.key.urlsafe()}}" id="subscribe">Subscribe</button>
			</div>
		</form>

		<div id="mapContainer" ">
			<div id="map"></div>
		</div>
			<script>

			  function initMap() {

				var map = new google.maps.Map(document.getElementById('map'), {
				  zoom: 3,
				  center: {lat: -28.024, lng: 140.887}
				});

				// Create an array of alphabetical characters used to label the markers.
				var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

				// Add some markers to the map.
				// Note: The code uses the JavaScript Array.prototype.map() method to
				// create an array of markers based on a given "locations" array.
				// The map() method here has nothing to do with the Google Maps API.
				var markers = locations.map(function(location, i) {
				  return new google.maps.Marker({
					position: location,
					label: labels[i % labels.length]
				  });
				});

				// Add a marker clusterer to manage the markers.
				var markerCluster = new MarkerClusterer(map, markers,
					{imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
			  }
			  var locations = [
				{lat: -31.563910, lng: 147.154312},
				{lat: -33.718234, lng: 150.363181},
				{lat: -33.727111, lng: 150.371124},
				{lat: -33.848588, lng: 151.209834},
				{lat: -33.851702, lng: 151.216968},
				{lat: -34.671264, lng: 150.863657},
				{lat: -35.304724, lng: 148.662905},
				{lat: -36.817685, lng: 175.699196},
				{lat: -36.828611, lng: 175.790222},
				{lat: -37.750000, lng: 145.116667},
				{lat: -37.759859, lng: 145.128708},
				{lat: -37.765015, lng: 145.133858},
				{lat: -37.770104, lng: 145.143299},
				{lat: -37.773700, lng: 145.145187},
				{lat: -37.774785, lng: 145.137978},
				{lat: -37.819616, lng: 144.968119},
				{lat: -38.330766, lng: 144.695692},
				{lat: -39.927193, lng: 175.053218},
				{lat: -41.330162, lng: 174.865694},
				{lat: -42.734358, lng: 147.439506},
				{lat: -42.734358, lng: 147.501315},
				{lat: -42.735258, lng: 147.438000},
				{lat: -43.999792, lng: 170.463352}
			  ]
			</script>
			<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
			</script>
			<script async defer
			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDosJXIOAqz2lNj9K0vnGKnbOg1ZcapiIY&callback=initMap">
			</script>
{% endblock content %}